â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                          â•‘
â•‘           ğŸ”§ CORREÃ‡ÃƒO APLICADA - REGEX DO ORD SERVER HTML ğŸ”§            â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… PROBLEMA IDENTIFICADO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

O endpoint `/output/{txid}:{vout}` do ORD server retorna runes em formato
de TABELA HTML, nÃ£o no formato simples que esperÃ¡vamos.

ANTES (formato esperado):
<dt>runes</dt><dd><a href=/rune/DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON>DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON</a>: 1000ğŸ•</dd>

AGORA (formato real):
<dt>runes</dt>
<dd>
  <table>
    <tr>
      <td><a href=/rune/DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON>DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON</a></td>
      <td>1000 ğŸ•</td>
    </tr>
  </table>
</dd>

âœ… CORREÃ‡ÃƒO APLICADA:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Arquivo: server/utils/runesDecoder.js
FunÃ§Ã£o: getRuneUtxos()

ANTES:
const runeInOutputPattern = new RegExp(
  `<a[^>]*href=\\/rune\\/${runeName}[^>]*>${runeName}<\\/a>:\\s*([\\d,]+)`,
  'i'
);

AGORA:
// Verifica se tem <dt>runes</dt> no HTML
if (outputHtml.includes('<dt>runes</dt>')) {
    // Procura pela rune na tabela:
    // <td><a href=/rune/NOME>NOME</a></td><td>AMOUNT EMOJI</td>
    const runeInTablePattern = new RegExp(
        `<td><a[^>]*href=\\/rune\\/${escapedRuneName}[^>]*>${escapedRuneName}<\\/a><\\/td>\\s*<td>([\\d,]+)`,
        'i'
    );
}

ğŸ§ª COMO TESTAR AGORA:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£  REINICIE O BACKEND:

    Terminal â†’ cd /Users/tomkray/Desktop/PSBT-Ordinals
    
    # Mate o processo antigo:
    lsof -ti:3000 | xargs kill -9
    
    # Inicie o novo:
    node server/index.js

2ï¸âƒ£  TESTE NA MYWALLET EXTENSION:

    a) Chrome â†’ chrome://extensions/
    b) Recarregue a extensÃ£o MyWallet (botÃ£o âŸ³)
    c) Abra a wallet
    d) Tab "Runes"
    e) Clique em "DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON"
    f) Clique em "Send"
    g) Preencha:
       â€¢ Recipient: bc1pggclc3c6u4xa4u00js0hey4fmq6h8kx93ltapwgqn03kz0pk3n8q5nchag
       â€¢ Amount: 500 (ou qualquer valor atÃ© 1000)
       â€¢ Fee Rate: 1 sat/vB
    h) Clique em "Send Rune"

3ï¸âƒ£  O QUE ESPERAR:

   Backend logs devem mostrar:
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸš€ ========== BUILD RUNE SEND PSBT ==========
   ...
   ğŸ“¡ Step 2.5: Fetching UTXOs with this rune via ORD server...
      Found 3 outputs for this address
      âœ… Found rune in output 0990800988bde260...a28:2 - Amount: 1000
      âœ… Found 1 UTXOs containing "DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON"
   
   ğŸ”¨ Step 3: Building Runestone...
      âœ… Runestone built
   
   âœ… PSBT created successfully!
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

   Extension console deve mostrar:
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ“¦ Step 1: Building PSBT...
      âœ… PSBT received from backend
   
   ğŸ” Step 2: Signing PSBT...
      âœ… PSBT signed locally
   
   ğŸ“¡ Step 3: Broadcasting transaction...
      âœ… TX broadcast! TXID: abc123...
   
   ğŸ‰ Rune sent successfully!
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

4ï¸âƒ£  VERIFICAR TRANSAÃ‡ÃƒO:

   a) Copie o TXID que apareceu
   b) Acesse: https://mempool.space/tx/TXID
   c) Veja a transaÃ§Ã£o no mempool!
   d) Aguarde confirmaÃ§Ã£o (prÃ³ximos blocos)

5ï¸âƒ£  VERIFICAR NO ORD SERVER:

   Depois da confirmaÃ§Ã£o:
   
   a) EndereÃ§o DE (remetente):
      http://localhost/address/bc1pvz02d8z6c4d7r2m4zvx83z5ng5ggx7pkhx796hdtd9aef85hlk9q3m36gx
      Deve mostrar: 500 DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON (se enviou 500)
   
   b) EndereÃ§o PARA (destinatÃ¡rio):
      http://localhost/address/bc1pggclc3c6u4xa4u00js0hey4fmq6h8kx93ltapwgqn03kz0pk3n8q5nchag
      Deve mostrar: 500 DOGâ€¢GOâ€¢TOâ€¢THEâ€¢MOON (as que vocÃª enviou)

ğŸ“Š STATUS DA CORREÃ‡ÃƒO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… Regex corrigido para formato de tabela HTML
âœ… Agora reconhece <td> ao invÃ©s de texto simples
âœ… Escape correto de caracteres especiais (â€¢)
âœ… VerificaÃ§Ã£o se seÃ§Ã£o <dt>runes</dt> existe

ğŸ¯ PRÃ“XIMO PASSO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

REINICIE O BACKEND E TESTE NA EXTENSION!

Se der certo, vocÃª verÃ¡:
âœ… PSBT criado
âœ… TX assinada
âœ… TX no mempool
âœ… Runes transferidas!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    ğŸ‰ PRONTO PARA ENVIAR RUNES! ğŸ‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


